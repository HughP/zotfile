<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Zotfile by jlegewie</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <!-- flattr -->
  <script type="text/javascript">
  /* <![CDATA[ */
      (function() {
          var s = document.createElement('script'), t = document.getElementsByTagName('script')[0];
          s.type = 'text/javascript';
          s.async = true;
          s.src = 'http://api.flattr.com/js/0.6/load.js?mode=auto';
          t.parentNode.insertBefore(s, t);
      })();
  /* ]]> */
  </script>
  <!-- twitter -->
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
  </script>
  <body>
    <div class="wrapper">
      <header>
        <h1 style="margin:0 0 10px;">Zotfile</h1>
        <h4 style="margin:0 0 25px;">Advanced PDF management for Zotero</h4>

        <p class="view">
          <a href="https://addons.mozilla.org/en-US/firefox/addon/zotfile/">DOWNLOAD</a><br>
          <a href="https://github.com/jlegewie/zotfile">View the Project on GitHub</a>
        </p>

        <form action="https://www.paypal.com/cgi-bin/webscr" onClick="_gaq.push(['_trackEvent', 'external-links', 'donation']);" method="post">
          <input type="hidden" name="cmd" value="_s-xclick">
          <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----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-----END PKCS7-----
          ">
          &nbsp;&nbsp;&nbsp;&nbsp;<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
          &nbsp;&nbsp;&nbsp;&nbsp;<a class="FlattrButton" style="display:none;" rev="flattr;button:compact;" href="http://www.columbia.edu/~jpl2136/zotfile.html"></a>
          <noscript><a href="http://flattr.com/thing/344324/ZotFile" target="_blank">
          <img src="http://api.flattr.com/button/flattr-badge-large.png" alt="Flattr this" title="Flattr this" border="0" /></a></noscript>
          <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
          </form>

          <br><br>
          <h3 style="margin:0 0 5px;">Content</h3>
          <p class="view">
            <a href="#features">Features</a><br>
            <a href="#install-zotfile">Install Zotfile</a><br>
            <a href="#renaming-rules">Renaming Rules</a><br>
            <a href="#user-defined-wildcards">User-Defined Wildcards</a><br>
            <a href="#hidden-options">Hidden Options</a><br>
            <a href="#bug">Reporting a Bug</a><br>
            <a href="#changelog">Changelog</a><br>
          </p>

          <a href="https://twitter.com/share" class="twitter-share-button" data-url="http://jlegewie.com/zotfile.html" data-text="ZotFile: Advanced PDF management for Zotero" data-size="large">Tweet</a>

      </header>
      <section>


<h3>
<a name="features" class="anchor" href="#features"><span class="octicon octicon-link"></span></a>FEATURES</h3>

<p>Zotfile is a Zotero plugin to manage your attachments: automatically rename, move, and attach PDFs (or other files) to Zotero items, sync PDFs from your Zotero library to your (mobile) PDF reader (e.g. an iPad, Android tablet, etc.) and extract annotations from PDF files.</p>

<h4>
<a name="-attach-new-files-to-zotero-items" class="anchor" href="#-attach-new-files-to-zotero-items"><span class="octicon octicon-link"></span></a>★ Attach New Files to Zotero Items</h4>

<p>ZotFile can rename and add the most recently modified file from the Firefox download or a user specified folder as a new attachment to the currently selected Zotero item. It renames the file using metadata from the selected Zotero item (user configurable), and stores the file as a Zotero attachment to this item (or alternatively, moves it to a custom location).</p>

<h4>
<a name="-batch-rename-and-move-attachments-based-on-zotero-metadata" class="anchor" href="#-batch-rename-and-move-attachments-based-on-zotero-metadata"><span class="octicon octicon-link"></span></a>★ (Batch) Rename and Move Attachments based on Zotero Metadata</h4>

<p>The user can also select any number of Zotero items and automatically rename and move all attachments of these items according to the user defined rules using metadata of the respective zotero item (batch processing).</p>

<h4>
<a name="-sync-pdfs-with-your-ipad-or-android-tablet" class="anchor" href="#-sync-pdfs-with-your-ipad-or-android-tablet"><span class="octicon octicon-link"></span></a>★ Sync PDFs with your iPad or Android tablet</h4>

<p>To read and annotate PDF attachments on your mobile device, zotfile can sync PDFs from your Zotero library to your (mobile) PDF reader (e.g. an iPad, Android tablet, etc.). Zotfile sends files to a location on your PC or Mac that syncs with your PDF reader App (PDF Expert, iAnnotate, GoodReader etc.), allows you to configure custom subfolders for easy access, and even extracts the annotations and highlighted text to Zotero notes when you get the files back from your tablet. Instructions are below.</p>

<h4>
<a name="-extract-annotations-from--pdf-files" class="anchor" href="#-extract-annotations-from--pdf-files"><span class="octicon octicon-link"></span></a>★ Extract Annotations from  PDF Files</h4>

<p>After highlighting and annotating pdfs on your tablet (or with the PDF reader application on your computer), ZotFile can automatically extract the highlighted text and note annotations from the pdf. The extracted text is saved in a Zotero note. Thanks to Joe Devietti, this feature is now available on all platforms based on the pdf.js library.</p>

<p><img src="pics/pdf-annotation-full.png" alt="pdf annotation and highlight extraction"></p>

<h3>
<a name="install-zotfile" class="anchor" href="#install-zotfile"><span class="octicon octicon-link"></span></a>INSTALL ZOTFILE</h3>

<p>To start using zotfile, make sure that Zotero is installed and follow these simple steps:</p>

<ol>
<li>
<p>Install ZotFile</p>

<p>For <em>Zotero Firefox</em>, click on the the download link above and follow the instructions on the Mozilla Add-Ons page. For <em>Zotero Standalone</em>, first download the extension file (follow the download link above, click on 'Continue to Download'. In Firefox, right-click 'Add to Firefox' and select 'Save Link As'. In other browsers, click on 'Download Now' (it's greyed out) and then 'download anyway'). Now start Zotero Standalone, and go to 'Tools-&gt;Add-ons-&gt;Tools for all Add-ons (the small,drop-down wheel in the top right corner)-&gt;Install Add-on From File' and pick the downloaded .xpi file.</p>
</li>
<li>
<p>Change the Source Folder for Attaching new Files</p>

<p>To attach new files to Zotero items, zotfile looks  for the most recently modified (e.g. just downloaded) file in a user specified folder. For Zotero Firefox, this option is set to the Firefox download folder by default. For Zotero Standalone, this option has to be changed on the 'General Settings' tab in the preference window (Zotero Actions -&gt; ZotFile Preferences). The source folder can be set to any location but I generally recommend setting it to your browser's download folder such as ~/Downloads on the mac for most browsers.</p>
</li>
<li>
<p>Changing other Options (optional)</p>

<p>ZotFile offers many other options that can be changed by the user. Most of them are located in the zotfile preference window under Zotero Actions -&gt; ZotFile Preferences.</p>
</li>
</ol><h4>
<a name="syncing-pdf-attachments-with-your-ipad-or-android-tablet" class="anchor" href="#syncing-pdf-attachments-with-your-ipad-or-android-tablet"><span class="octicon octicon-link"></span></a>Syncing pdf attachments with your ipad or android tablet</h4>

<p>To read and annotate PDF attachments on your mobile device, zotfile can sync PDFs from your Zotero library to your (mobile) PDF reader (e.g. an iPad, Android tablet, etc.). For this purpose, Zotfile sends files to a location on your PC or Mac that syncs with your PDF reader App (PDF Expert, iAnnotate, GoodReader etc.), and gets them back when you have finished reading them. To get started, first set up a folder on your PC or Mac that syncs with your tablet reader application. Files that are copied to this folder should automatically appear in your PDF reader application. One possibility is Dropbox, which is free for up to 2GB of space and works with most PDF reader apps. More detailed instructions as well as alternative options should be available on the website of your PDF reader App. Second, open the 'Tablet Settings' tab in the zotfile preference window and enable the option 'Use ZotFile to send and get files from tablet'. Third, change the zotfile location for files on the tablet to the folder that syncs with your pdf reader app ('Base Folder' on the 'Tablet Settings' tab). Forth (optional), set up subfolders that make it easy to sort your files in the tablet folder so that you can easily find them on your tablet.
You can now start sending pdfs (or other files) to your tablet. Simply right-click on a zotero item and select 'Send to Tablet' under 'Manage Attachments'. When you are done reading and annotating your pdf, just get the file back from the tablet by clicking on 'Get from Tablet' under 'Manage Attachments'. ZotFile will automatically remove the file from your tablet folder and extract the annotations from the pdf file to a zotero note. Alternatively, you can use the 'Scan Tablet Files' function in Zotero's Action Menu to automatically check whether any files in the tablet folder have changed. ZotFile then asks the user how to proceed for each modified file.</p>

<h3>
<a name="renaming-rules" class="anchor" href="#renaming-rules"><span class="octicon octicon-link"></span></a>RENAMING RULES</h3>

<p><img src="pics/zotfile-reader-rename.jpg" alt="preference window"></p>

<p>ZotFile renames files based on bibliographic information from the currently selected Zotero item. You can change the renaming rules in the zotfile preference window under renaming rules (Zotero Actions -&gt; ZotFile Preferences). The option 'Renaming Format' allows you to create custom renaming rules using wildcards, which are replaced by metadata from the selected Zotero item. Zotfile also supports optional and exclusive wild-cards. Optional wild-cards mean that <code>{-%y}</code> only includes the seperator <code>-</code> in the filename if <code>%y</code> is defined. Exclusive wild-cards such as <code>%s|%j</code> will generate the entry for <code>%s</code> if that exists and the entry for <code>%j</code> otherwise. Other characters between the wildcards and the bar are ignored (<code>%s | stuff %j | - more %p</code> is equivalent to <code>%s|%j|%p</code>). Some examples are below.</p>

<h5>
<a name="wildcards" class="anchor" href="#wildcards"><span class="octicon octicon-link"></span></a>Wildcards</h5>

<ul>
<li><code>%a</code> last names of authors (not editors etc) or inventors. The maximum number of authors are changed under 'Additional Settings'.</li>
<li><code>%I</code> author initials.</li>
<li><code>%F</code> author's last name with first letter of first name (e.g. EinsteinA).</li>
<li><code>%A</code> first letter of author (useful for subfolders)</li>
<li><code>%y</code> year (extracted from Date field)</li>
<li><code>%t</code> title. Usually truncated after : . ? The maximal length of the remaining part of the title can be changed.</li>
<li><code>%T</code> item type (localized)</li>
<li><code>%j</code> name of the journal</li>
<li><code>%p</code> name of the publisher</li>
<li><code>%w</code> name of the journal, publisher, meeting name for presentation etc.</li>
<li><code>%s</code> journal abbreviation</li>
<li><code>%v</code> journal volume</li>
<li><code>%e</code> journal issue</li>
<li><code>%f</code> pages</li>
<li><code>%x</code> extra</li>
<li><code>%n</code> patent number (patent items only)</li>
<li><code>%i</code> assignee (patent items only)</li>
<!-- <li> <code>%u</code> issue date (patent items only)</li> -->
</ul>

<h4>
  <a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Examples
</h4>

<p>Abbott, Andrew, and Alexandra Hrycak (1990): Measuring Resemblance in Sequence Data: An Optimal Matching Analysis of Musicians' Careers. American Journal of Sociology 96:144-185.</p>

<ul>
<li>
<p><code>{%a}{-%y}{-%j (%s)}</code> - Abbott-1990-American Journal of Sociology (AJS)</p>

<p>(if either "%j" or "%s" is empty, "Abbott-1990")</p>
</li>
<li><p><code>{%a-}{%y-}{%s|%j}</code> - "Abbott-1990-AJS" or "Abbott-1990-American Journal of Sociology" if "%s" is empty</p></li>
<li><p><code>{%a_}{%y_}{%t}</code>: Abbott_Hrycak_1990_Measuring Resemblance in Sequence Data</p></li>
<li>
<code>%a-%y %t</code>: Abbott_Hrycak-1990 Measuring Resemblance in Sequence Data</li>
<li>
<p><code>{%w_}{%y_}{%a}</code>: American Journal of Sociology_1990_Abbott_Hrycak</p>

<p>With 'Maximum number of authors' set to 1 and 'Add suffix ...' set to 'et al'</p>
</li>
<li>
<p><code>%a_%y_%t</code>: Abbott et al_1990_Measuring Resemblance in Sequence Data</p>

<p>With 'Maximum number of authors' set to 1, 'Add suffix ...' disabled, and  'Maximum length of title' set to 10</p>
</li>
<li>
<code>%a_%y_%t</code>: Abbott_1990_Measuring</li>
</ul><h3>
<a name="user-defined-wildcards" class="anchor" href="#user-defined-wildcards"><span class="octicon octicon-link"></span></a>USER-DEFINED WILDCARDS</h3>

<p>All wildcards are now defined in the hidden preference <code>zotfile.wildcards.default</code> and can be changed by the user. But I <strong>strongly</strong> suggest that you do not change this preference. Instead, there is a second hidden preference  <code>zotfile.wildcards.user</code> that allows you to add and overwrite wildcards (hidden preference can be changed in <code>about:config</code>). This is a preference is for advanced user without any error checking so be careful what you do! By default, <code>zotfile.wildcards.user</code> is set to <code>{}</code> so that no user wildcards are defined. Below is an example JSON that defines wildcards for <code>%1</code>, <code>%2</code>, <code>%3</code>, <code>%4</code> illustrating all the possibilities:</p>

<ol>
<li>String with the name of Zotero field (<code>%1</code>)</li>
<li>
<p>JSON with item type specific field names (<code>%2</code>)</p>

<p>Always include a <code>default</code> value. Otherwise this is not going to work. A list of all item types is available <a href="https://api.zotero.org/itemTypes?pprint=1">here</a>.</p>
</li>
<li>
<p>JSON with three elements for field, regular expression, and group (<code>%3</code>)</p>

<p>ZotFile uses the specified <code>field</code> as an input string, searches for a match using the regular expression <code>regex</code> based on the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec">exec() function</a>, and returns the element specified in <code>group</code> so that <code>0</code> returns the matched text and higher values the corresponding capturing parenthesis. If the match fails, Zotfile uses the original field data. The value of <code>field</code> can either be the name of a Zotero field such as <code>title</code> or a javascript object with item type specific field names (see 2). You can also add a fourth optional element <code>transform</code>, which converts the output to lower case <code>lowerCase</code>, to upper case <code>upperCase</code>, or trims it <code>trim</code>.</p>
</li>
<li><p>Finally, the wildcard <code>%4</code> combines item type specific field names with regular expression.</p></li>
</ol><h5>
<a name="example-for-user-defined-wildcards" class="anchor" href="#example-for-user-defined-wildcards"><span class="octicon octicon-link"></span></a>Example for user-defined wildcards</h5>

<div class="highlight highlight-json"><pre><span class="p">{</span>
    <span class="nt">"1"</span><span class="p">:</span> <span class="s2">"publicationTitle"</span><span class="p">,</span>
    <span class="nt">"2"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"default"</span><span class="p">:</span> <span class="s2">"publicationTitle"</span><span class="p">,</span>
        <span class="nt">"book"</span><span class="p">:</span> <span class="s2">"publisher"</span><span class="p">,</span>
        <span class="nt">"bookSection"</span><span class="p">:</span> <span class="s2">"publisher"</span>
    <span class="p">},</span>
    <span class="nt">"3"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"field"</span><span class="p">:</span> <span class="s2">"title"</span><span class="p">,</span>
        <span class="nt">"regex"</span><span class="p">:</span> <span class="s2">"([\\w ,-]{1,50})[:\\.?!]?"</span><span class="p">,</span>
        <span class="nt">"group"</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">},</span>
    <span class="nt">"4"</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">"default"</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">"field"</span><span class="p">:</span> <span class="s2">"title"</span><span class="p">,</span>
            <span class="nt">"regex"</span><span class="p">:</span> <span class="s2">"([\\w ,-]{1,10})[:\\.?!]?"</span><span class="p">,</span>
            <span class="nt">"group"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nt">"transform"</span><span class="p">:</span> <span class="s2">"upperCase"</span>
        <span class="p">},</span>
        <span class="nt">"journalArticle"</span><span class="p">:</span> <span class="s2">"publicationTitle"</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h5>
<a name="item-types-and-field-names" class="anchor" href="#item-types-and-field-names"><span class="octicon octicon-link"></span></a>Item types and field names</h5>

<p>A complete list of Zotero fields is available <a href="https://api.zotero.org/itemFields?pprint=1">here</a> and all the item types are <a href="https://api.zotero.org/itemTypes?pprint=1">here</a>. The fields for each item type are listed on <a href="http://aurimasv.github.io/z2csl/typeMap.xml">this page</a>. Zotfile defines a number of <em>additional fields</em> that can be used as part of wildcards: <code>itemType</code> is the language specific item type, <code>formatedTitle</code> is the title formatted using the options defined in the zofile preferences, <code>author</code> is the author string formatted using the zotfile preferences, <code>authorLastF</code> is the author string formatted as LastnameF, and <code>authorInitials</code> are the initial of the authors.</p>

<h5>
<a name="formatting-rules" class="anchor" href="#formatting-rules"><span class="octicon octicon-link"></span></a>Formatting rules</h5>

<p>There are a couple of formatting rules for the user-defined wildcards:</p>

<ul>
<li>Wildcards can only be one character</li>
<li>Use double escape characters in regular expression so that a <code>\d</code> becomes <code>\\d</code>
</li>
<li>Always use <code>"</code> never <code>'</code>
</li>
</ul><p>Check out <code>zotfile.wildcards.default</code> for more examples (see below). Finally, the JSON has to be reformatted to one line that can be pasted into the preference field in <code>about:config</code>.</p>

<p><code>{"1": "publicationTitle", "2": {"default": "publicationTitle", "book": "publisher", "bookSection": "publisher"}, "3": {"field": "title", "regex": "([\\w ,-]{1,50})[:\\.?!]?", "group": 1 }, "4": {"default": {"field": "title", "regex": "([\\w ,-]{1,10})[:\\.?!]?", "group": 1, "transform": "upperCase"}, "journalArticle": "publicationTitle"} }</code></p>

<p>You can use a javascript console such as Firefox's Scratchpad to test whether the JSON is properly</p>

<div class="highlight highlight-javascript"><pre><span class="nx">wildcard</span> <span class="o">=</span> <span class="s1">'{"1": "publicationTitle", "2": {"default": "publicationTitle", "book": "publisher", "bookSection": "publisher"}, "3": {"field": "title", "regex": "([\\w ,-]{1,50})[:\\.?!]?", "group": 1 }, "4": {"default": {"field": "title", "regex": "([\\w ,-]{1,10})[:\\.?!]?", "group": 1, "transform": "upperCase"}, "journalArticle": "publicationTitle"} }'</span><span class="p">;</span>
<span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">wildcard</span><span class="p">)</span>
</pre></div>

<h5>
<a name="default-setting-of-zotfilewildcardsdefault" class="anchor" href="#default-setting-of-zotfilewildcardsdefault"><span class="octicon octicon-link"></span></a>Default setting of <code>zotfile.wildcards.default</code>
</h5>

<p>Note that the information here might not be up to date. As a formated JSON:</p>

<div class="highlight highlight-json"><pre><span class="p">{</span>
  <span class="nt">"a"</span><span class="p">:</span> <span class="s2">"author"</span><span class="p">,</span>
  <span class="nt">"A"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"field"</span><span class="p">:</span> <span class="s2">"author"</span><span class="p">,</span>
    <span class="nt">"regex"</span><span class="p">:</span> <span class="s2">"\\w{1}"</span><span class="p">,</span>
    <span class="nt">"group"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="nt">"transform"</span><span class="p">:</span> <span class="s2">"upperCase"</span>
  <span class="p">},</span>
  <span class="nt">"F"</span><span class="p">:</span> <span class="s2">"authorLastF"</span><span class="p">,</span>
  <span class="nt">"I"</span><span class="p">:</span> <span class="s2">"authorInitials"</span><span class="p">,</span>
  <span class="nt">"t"</span><span class="p">:</span> <span class="s2">"titleFormated"</span><span class="p">,</span>
  <span class="nt">"h"</span><span class="p">:</span> <span class="s2">"shortTitle"</span><span class="p">,</span>
  <span class="nt">"j"</span><span class="p">:</span> <span class="s2">"publicationTitle"</span><span class="p">,</span>
  <span class="nt">"s"</span><span class="p">:</span> <span class="s2">"journalAbbreviation"</span><span class="p">,</span>
  <span class="nt">"p"</span><span class="p">:</span> <span class="s2">"publisher"</span><span class="p">,</span>
  <span class="nt">"w"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"default"</span><span class="p">:</span> <span class="s2">"publisher"</span><span class="p">,</span>
    <span class="nt">"audioRecording"</span><span class="p">:</span> <span class="s2">"label"</span><span class="p">,</span>
    <span class="nt">"bill"</span><span class="p">:</span> <span class="s2">"legislativeBody"</span><span class="p">,</span>
    <span class="nt">"case"</span><span class="p">:</span> <span class="s2">"court"</span><span class="p">,</span>
    <span class="nt">"computerProgram"</span><span class="p">:</span> <span class="s2">"company"</span><span class="p">,</span>
    <span class="nt">"film"</span><span class="p">:</span> <span class="s2">"distributor"</span><span class="p">,</span>
    <span class="nt">"journalArticle"</span><span class="p">:</span> <span class="s2">"publicationTitle"</span><span class="p">,</span>
    <span class="nt">"magazineArticle"</span><span class="p">:</span> <span class="s2">"publicationTitle"</span><span class="p">,</span>
    <span class="nt">"newspaperArticle"</span><span class="p">:</span> <span class="s2">"publicationTitle"</span><span class="p">,</span>
    <span class="nt">"patent"</span><span class="p">:</span> <span class="s2">"issuingAuthority"</span><span class="p">,</span>
    <span class="nt">"presentation"</span><span class="p">:</span> <span class="s2">"meetingName"</span><span class="p">,</span>
    <span class="nt">"radioBroadcast"</span><span class="p">:</span> <span class="s2">"network"</span><span class="p">,</span>
    <span class="nt">"report"</span><span class="p">:</span> <span class="s2">"institution"</span><span class="p">,</span>
    <span class="nt">"thesis"</span><span class="p">:</span> <span class="s2">"university"</span><span class="p">,</span>
    <span class="nt">"tvBroadcast"</span><span class="p">:</span> <span class="s2">"network"</span>
  <span class="p">},</span>
  <span class="nt">"n"</span><span class="p">:</span> <span class="s2">"patentNumber"</span><span class="p">,</span>
  <span class="nt">"i"</span><span class="p">:</span> <span class="s2">"assignee"</span><span class="p">,</span>
  <span class="nt">"y"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"field"</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">"default"</span><span class="p">:</span> <span class="s2">"date"</span><span class="p">,</span>
      <span class="nt">"patent"</span><span class="p">:</span> <span class="s2">"issueDate"</span>
    <span class="p">},</span>
    <span class="nt">"regex"</span><span class="p">:</span> <span class="s2">"\\d{4}"</span><span class="p">,</span>
    <span class="nt">"group"</span><span class="p">:</span> <span class="mi">0</span>
  <span class="p">},</span>
  <span class="nt">"v"</span><span class="p">:</span> <span class="s2">"volume"</span><span class="p">,</span>
  <span class="nt">"e"</span><span class="p">:</span> <span class="s2">"issue"</span><span class="p">,</span>
  <span class="nt">"T"</span><span class="p">:</span> <span class="s2">"itemType"</span><span class="p">,</span>
  <span class="nt">"f"</span><span class="p">:</span> <span class="s2">"pages"</span><span class="p">,</span>
  <span class="nt">"x"</span><span class="p">:</span> <span class="s2">"extra"</span>
<span class="p">}</span>
</pre></div>

<p>In one line so that you can copy it to <code>zotfile.wildcards.default</code> if you screw up:</p>

<p><code>{"a": "author", "A": {"field": "author", "regex": "\\w{1}", "group": 0, "transform": "upperCase"}, "F": "authorLastF", "I": "authorInitials", "t": "titleFormated", "h": "shortTitle", "j": "publicationTitle", "s": "journalAbbreviation", "p": "publisher", "w": {"default": "publisher", "audioRecording": "label", "bill": "legislativeBody", "case": "court", "computerProgram": "company", "film": "distributor", "journalArticle": "publicationTitle", "magazineArticle": "publicationTitle", "newspaperArticle": "publicationTitle", "patent": "issuingAuthority", "presentation": "meetingName", "radioBroadcast": "network", "report": "institution", "thesis": "university", "tvBroadcast": "network"}, "n": "patentNumber", "i": "assignee", "y": {"field": {"default": "date", "patent": "issueDate"}, "regex": "\\d{4}", "group": 0 }, "v": "volume", "e": "issue", "T": "itemType", "f": "pages", "x": "extra"}</code></p>

<h3>
<a name="hidden-options" class="anchor" href="#hidden-options"><span class="octicon octicon-link"></span></a>HIDDEN OPTIONS</h3>

<p>Zotfile has a number of hidden options that allow you to further configure zotfile. You can access the hidden options through about:config. In Zotero Firefox, type <code>about:config</code> in the url bar. In Zotero Standalone, go to Actions-&gt;Preferences-&gt;Advanced-&gt;Open <code>about:config</code>.</p>

<p>Search for <code>extensions.zotfile</code> to see a list of the hidden zotfile options. Here is a list of the options that can be changed by the user (I strongly discourage  to change any of the other options):</p>

<ul>
<li>
<p><code>.allFiles</code></p>

<p>By default, zotfile's 'Attach New File' function attaches the most recently modified file from the user defined folder. With this option set to true, zotfile attaches all files in the user defined folder to the currently selected zotero item. (Note: I haven't tested this for a while but it should still work)</p>
</li>
<li>
<p><code>.disable_renaming</code></p>

<p>Disable any renaming of files - just moves them to the specified location.</p>
</li>
<li>
<p><code>.tablet.mode</code></p>

<p>In <em>background mode</em> (mode=1, default), zotfile leaves zotero attachments at their current location and moves a copy of the file to the tablet folder (set in the zotfile preference window) when they are send to the tablet. Getting the file back from the tablet replaces the zotero attachment file and removes it from the tablet folder. This mode is recommended when you sync attachment files in your zotero library across multiple computers or when you index your attachments.</p>

<p>The <em>foreground mode</em> (mode=2) moves the attachment file to the tablet folder and links to this location from zotero. In this mode there is always only one copy of the file. You can not, however, sync linked attachments to the zotero server.</p>
</li>
<li>
<p><code>.confirmRepush</code></p>

<p>By default, zotfile asks the user whether an attachment should be send to the tablet that is already on the tablet, which can be useful to move it to a different subfolder. This user confirmation can be disabled with this option.</p>
</li>
<li>
<p><code>.tablet.tagParentPush.tablet.tagParentPush_tag.tablet.tagParentPull.tablet.tagParentPull_tag</code></p>

<p>These options allow the user to tag the parent item when sending (push) or getting back (pull) attachments to or from the tablet.</p>
</li>
<li>
<p><code>.pdfExtraction.NoteHtmlTagStart</code>, <code>.pdfExtraction.NoteHtmlTagEnd</code>, <code>.pdfExtraction.HighlightHtmlTagStart</code>, <code>.pdfExtraction.HighlightHtmlTagEnd</code>, <code>.pdfExtraction.UnderlineHtmlTagStart</code>, <code>.pdfExtraction.UnderlineHtmlTagEnd</code></p>

<p>These options allow the user to fine-tune the formatting of the extracted PDF annotations in the zotero note. They define the opening and closing html tag for different types of annotations. The default settings format highlighted text from the pdf normally, note text in italics (&lt;i&gt; for start and &lt;/i&gt; for end), and underline underlined text (&lt;u&gt; for start and &lt;/u&gt; for end). The end options for note, highlight and underline have to be the closing tag for the corresponding start option.</p>
</li>
<li>
<p><code>.pdfExtraction.NoteRemoveHyphens</code></p>

<p>By default, zotfile removes hyphens from extracted text. Setting NoteRemoveHyphens to false, disables this option.</p>
</li>
<li>
<p><code>.UsePDFJSandPoppler</code></p>

<p>With this option, zotfile extracts PDF annotations twice using both pdf.js and poppler. This option only works on Mac OS when the poppler based extraction script is installed.</p>
</li>
</ul><h3>
<a name="bug" class="anchor" href="#bug"><span class="octicon octicon-link"></span></a>REPORTING A BUG</h3>

<p>You can report bugs on the <a href="http://forums.zotero.org/discussion/5301/6/zotfile-zotero-plugin-to-rename-move-and-attach-pdfs-send-them-to-ipad-extract-pdf-annotations/">Zotfile thread</a> in the Zotero forum. Please provide information about about your system (Windows, Mac OS, Linux etc) as well as your Zotfile, Zotero and Firefox version. Also make sure that you can reproduce the bug and describe the steps as closely as possible. In addition, any information from the Error Console are very helpful. You can check the Error Console in Zotero for Firefox by going to 'Tools-&gt;Web Dev.-&gt;Error Console' in Firefox and look for any zotfile related stuff after the bug occurred. For zotfile bugs,  the 'Source File' should be something like <code>chrome://zotfile/content/...</code> (most likely zotfile.js). You can also clear the console, execute the actions that caused the problem and then check again. If I ask you to provide a Report ID, follow the instructions <a href="http://www.zotero.org/support/reporting_bugs">here</a>.</p>

<h3>
<a name="changelog" class="anchor" href="#changelog"><span class="octicon octicon-link"></span></a>CHANGELOG</h3>

<h4>
<a name="changes-in-31" class="anchor" href="#changes-in-31"><span class="octicon octicon-link"></span></a>Changes in 3.1</h4>

<ul>
<li>User-defined wildcards</li>
<li>watch folder now adds an attachment and retrieves metadata if no file is selected
(change message, change version)</li>
<li>The <code>%w</code> wildcard now maps to the correct field for most item types</li>
<li>The <code>%u</code> wildcard as redundant (use <code>%y</code> instead)</li>
<li>Choose the number of authors to display when truncating authors during renaming (thanks to bwiernik)</li>
<li>fix problem that small info window does not disappear</li>
<li>fix <code>TypeError: f.exists</code> error</li>
</ul><h4>
<a name="changes-in-303" class="anchor" href="#changes-in-303"><span class="octicon octicon-link"></span></a>Changes in 3.0.3</h4>

<ul>
<li>fix for issue with showing website on every restart</li>
<li>fix for issue when adding new attachment</li>
</ul><p>Other small fixes mainly for Italian translation, restriction of saved searches and renaming based on collections.</p>

<h4>
<a name="changes-in-30" class="anchor" href="#changes-in-30"><span class="octicon octicon-link"></span></a>Changes in 3.0</h4>

<ul>
<li>
<p><strong>Improved extraction of annotation</strong></p>

<p>The extraction of pdf annotations using pdf.js works much better now! Zotfile uses a modified version of the updated <a href="https://github.com/mozilla/pdf.js">pdf.js</a> library (<a href="https://github.com/jlegewie/pdf.js">here</a> is the fork). The new version supports more pdf standards, detects spaces more precisely, sorts annotations in the correct order, and future updates to new versions of pdf.js are relatively easy. There are still  pdfs that won't work though! Some pdf standards are not yet supported and if you can not copy &amp; paste text from the pdf file using your pdf viewer (e.g. Preview), it's unlikely that zotfile can help.</p>
</li>
<li>
<p><strong>Goto annotation in pdf</strong></p>

<p>The extracted annotations now include a link that opens the pdf file on the corresponding page. For the extracted annotation <code>"This is my text" (zotfile 2013: 4)</code>, <code>zotfile 2013: 4</code> is a link that opens the pdf on the page with the annotation. Currently, this feature only works from reports (right-click on item and select <code>generate report</code>) but future version of Zotero might be able to open the links directly from the note (see discussion <a href="https://forums.zotero.org/discussion/15186/clickable-links-in-notes/">here</a> and <a href="https://forums.zotero.org/discussion/25832/note-hyperlinks-in-standalone/">here</a>)</p>
</li>
<li>
<p><strong>Tablet feature: Restrict saved search for tablet files to sub-folders</strong></p>

<p>You can now right-click on the two saved searches for tablet files and restrict them to one of your custom sub-folders. This is very helpful to quickly see the files that are in a specific sub-folder.</p>
</li>
<li>
<p><strong>Tablet feature: Support of colored tags in Zotero 4</strong></p>

<p>Zotfile now tags the parent item when an attachment is send to the tablet so that you can easily see which items are on the tablet. Simply assign colors to the two tablet tags (<code>_tablet</code> and <code>_tablet_modified</code>). But DO NOT manually add the tag to items or attachments (also not using the keys for colored tags).</p>

</li>
<li><p>Italian localization (thanks to Roberto Caviglia)</p></li>
<li>Remove empty sub-folders when getting files from tablet</li>
<li>Fix alert window (headline was missing in Zotero 4)</li>
<li>Fix automatic renaming option "Only ask if..."</li>
<li>Fix for zotfile item menu on Zotero as a tab</li>
</ul><h4>
<a name="changes-in-234" class="anchor" href="#changes-in-234"><span class="octicon octicon-link"></span></a>Changes in 2.3.4</h4>

<ul>
<li>compatible with Zotero 4.0</li>
<li>Annotation extraction compatible with FF 20</li>
</ul><h4>
<a name="changes-in-231" class="anchor" href="#changes-in-231"><span class="octicon octicon-link"></span></a>Changes in 2.3.1</h4>

<ul>
<li>adding attachments from watched folder now works when child item is selected</li>
<li>language improvements for French and German</li>
<li>bug fix for subfolders based on wildcards</li>
</ul><h4>
<a name="changes-in-23" class="anchor" href="#changes-in-23"><span class="octicon octicon-link"></span></a>Changes in 2.3</h4>

<ul>
<li>
<p><strong>enhanced renaming rules</strong> (thanks to <a href="https://github.com/Midnighter">Midnighter</a>)</p>

<p>1) Optional wild-cards: <code>{-%y}</code> only includes <code>-</code> if  <code>%y</code> is defined.</p>

<p>2) Exclusive wild-cards: <code>%s|%j</code> journal abbr. or if not defined full journal name.</p>

<p>(for examples see below)</p>
</li>
<li><p>additional wild-cards for author formating (author initials <code>%I</code> and lastnameF <code>%F</code>), pages (<code>%f</code>) and short title (<code>%h</code>)</p></li>
<li>
<p><strong>watch source folder for new files</strong></p>

<p>Whenever the focus changes to the item list in Zotero, Zotfile checks for new files in the source folder. If a new file was added to the folder, zotfile uses a clickable, non-disruptive window to ask the user whether s/he wants to attach that file to the currently selected Zotero item.</p>
</li>
<li>
<p><strong>revised auto rename with additional options</strong></p>

<p>Four options: Never, Always ask, Only ask if item has other atts, Always rename. The 'asking' uses a clickable, non-disruptive window that appears in the bottom right corner - same as previous info window but clickable.</p>
</li>
<li><p><strong>revised notifications and error handling</strong></p></li>
<li>
<strong>Zotfile translation to German</strong> (thanks to <a href="https://github.com/wuffi">wuffi</a>) <strong>and French</strong> (thanks to <a href="https://github.com/gracile-fr">gracile-fr</a>)</li>
<li>Allow periods as delimiter in filenames (thanks to <a href="https://github.com/jjatria">jjatria</a>)</li>
<li>new option: "lower case" filenames (thanks to <a href="https://github.com/jjatria">jjatria</a>)</li>
<li>new option: disable renaming so that attachments are only moved (hidden: <code>.disable_renaming</code>)</li>
<li>new option: set opening and closing quotation mark for extracted annotations (hidden: <code>.openingQuotationMarks</code>, <code>.closingQuotationMarks</code>)</li>
<li>new option: remove periods from filenames (hidden: <code>removePeriods</code>)</li>
<li>bug fix: download of poppler tool was broken</li>
<li>bug fix: preview of renaming rules for Unix and Windows</li>
<li>bug fix: sending to and getting from tablet deleted note content</li>
</ul><p><strong>Examples for enhanced renaming rules</strong>
<code>%j</code> - journal; <code>%s</code> - journal abbreviation</p>

<p><code>{%a}{-%y}{-%j (%s)}</code> - <code>author-2001-Proceedings of the National Academy of Sciences (PNAS)</code>
(if either <code>%j</code> or <code>%s</code> is empty, <code>author-2001</code>)</p>

<p><code>{%a-}{%y-}{%s|%j}</code> - <code>author-2001-PNAS</code> or <code>author-2001-Proceedings...</code> if <code>%s</code> is empty</p>

<p>For full description, see <a href="#renaming-rules">renaming rules</a>.</p>

<h4>
<a name="changes-in-223" class="anchor" href="#changes-in-223"><span class="octicon octicon-link"></span></a>Changes in 2.2.3</h4>

<ul>
<li>bug fix: check whether selected attachments are valid (no top-level item, no web attachments and attachment exists)</li>
<li>bug fix: editing custom folder created error if user had maximum number of custom folders</li>
</ul><h4>
<a name="changes-in-222" class="anchor" href="#changes-in-222"><span class="octicon octicon-link"></span></a>Changes in 2.2.2</h4>

<ul>
<li>Add option to change delimiter between multiple authors (thanks to <a href="https://github.com/gracile-fr">gracile-fr</a>)</li>
</ul><h4>
<a name="changes-in-22" class="anchor" href="#changes-in-22"><span class="octicon octicon-link"></span></a>Changes in 2.2</h4>

<ul>
<li>New feature: automatic renaming of attachment files (thanks to <a href="www.rtwilson.com/academic">Robin Wilson</a>)</li>
<li>Bug fix: zotfile produced error when trying to move open files on Windows (thanks to Dominik)</li>
</ul><h4>
<a name="changes-in-21" class="anchor" href="#changes-in-21"><span class="octicon octicon-link"></span></a>Changes in 2.1</h4>

<ul>
<li>Important: the tag for tablet files was changed from '<em>READ' to '</em>tablet'</li>
<li>New saved search for modified files on tablet
(updates automatically, replaces 'Scan Tablet Files' function, which has been removed)</li>
<li>Zotfile menu items only appear for bibliographic items and attachments (not for notes)</li>
<li>Bug fix: allow the extraction of annotations in group libraries</li>
<li>Other bug fixes</li>
</ul><h4>
<a name="changes-in-20" class="anchor" href="#changes-in-20"><span class="octicon octicon-link"></span></a>Changes in 2.0</h4>

<ul>
<li>Sync Zotero Attachments with your iPad or Android tablet</li>
<li>Extract Annotations from PDF Files (thanks to Joe Devietti)</li>
<li>redesigned preference pane</li>
<li>many more features and bug fixes</li>
</ul>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/jlegewie">jlegewie</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-22825629-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>